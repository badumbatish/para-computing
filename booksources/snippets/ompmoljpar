for (int ip=0; ip<N; ip++) {
  double sumx=0., sumy=0., sumf=0.;
#pragma omp parallel for reduction(+:sumx,sumy,sumf) 
  for (int jp=0; jp<N; jp++) { 
    if (ip==jp) continue;
    struct force f = force_calc(points[ip],points[jp]);
    sumx += f.x; sumy += f.y; sumf += f.f;
  } // end parallel jp loop
  struct force sumforce = {sumx,sumy,sumf};
  add_force( forces+ip, sumforce );
} // end ip loop
