% -*- latex -*-
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%
%%%% This text file is part of the lecture slides for
%%%% `Parallel Computing'
%%%% by Victor Eijkhout, copyright 2020
%%%%
%%%% Bigdata-slides.tex : slides about messages beyond 2G
%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{numberedframe}{Partitioned communication (MPI-4)}
  Hybrid scenario:\\
  multiple threads contribute to one large message

  Partitioned send/recv:\\
  the contributions can be declared/tested
\end{numberedframe}

\begin{numberedframe}{Init calls}
  Similar to init calls for persistent sends,\\
  but specify the number of partitions.
\begin{lstlisting}
MPI_Psend_init
  (sendbuffer,nparts,SIZE,MPI_DOUBLE,tgt,0,
   comm,MPI_INFO_NULL,&send_request);
MPI_Precv_init
  (recvbuffer,nparts,SIZE,MPI_DOUBLE,src,0,
   comm,MPI_INFO_NULL,&recv_request);
\end{lstlisting}
\end{numberedframe}

\begin{numberedframe}{Partitioned send}
\cverbatimsnippet{psendsend}
\end{numberedframe}

\begin{numberedframe}{Partitioned receive}
  \cverbatimsnippet{psendrecv}
\end{numberedframe}

\begin{numberedframe}{Partitioned receive tests}
Use 
\begin{lstlisting}
MPI_Parrived(recv_request,ipart,&flag);
\end{lstlisting}
to test for arrived partitions.
\end{numberedframe}

